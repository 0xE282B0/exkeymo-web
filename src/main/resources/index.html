<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="How to remap Android external keyboard without root">
    <title>ExKeyMo - Android external keyboard remapping without root</title>
    <style>
        /* Style it because <code> looks ugly in Ghrome */
        code {
            margin: 0 2px;
            padding: 0px 5px;
            border: 1px solid #ddd;
            background-color: #f8f8f8;
            border-radius: 3px;
        }
    </style>
    <script>
        function setLayout(layout) {
          document.getElementById("layout").value = layout;
        }
    </script>
</head>
<body>
<h1>Android external keyboard remapping without root</h1>
<p>
    Since Android 4.1 an app can provide additional keyboard layouts (<a target="_blank" href="https://source.android.com/docs/core/input/key-character-map-files">Key Character 
Map files</a>). Since then it's possible to customize a keyboard layout without root access by installing an app that contains requred layout. ExKeyMo helps you to build such app even if you don't know anything about Android 
development.
</p>

<h2>How to</h2>
<ol>
    <li>Customize Key Character Map file content in the form below.
    <li>Click <code>Download</code>. ExKeyMo will build the app for you.</li>
    <li>Download the app and install it. The app is self-signed so Android will warn you about untrusted source or something like this. Note: if you install the app and get an error, try to uninstall the previous version first, if you have any.</li>
    <li>Go to <code>Settings -> Language & input -> Physical keyboard</code> (the exact path may vary), choose the keyboard you want to customize, and select <code>Custom</code> layout.</li>
</ol>

<form id="form" action="/" method="post"></form>
<div>
    <span>Examples:</span>
    <button onclick="setLayout('type OVERLAY')">Default</button>
    <button onclick="setLayout('type OVERLAY\n\nmap key 58 CTRL_LEFT')">Caps Lock as Left Ctrl</button>
    <button onclick="setLayout('type OVERLAY\n\nmap key 58 CTRL_LEFT\nmap key 29 CAPS_LOCK')">Swap Caps Lock and Left Ctrl</button>
    <button onclick="setLayout('type OVERLAY\n\nmap key 58 ESCAPE')">Caps Lock as Esc</button>
    <button onclick="setLayout('type OVERLAY\n\nmap key 58 ESCAPE\nmap key 1 CAPS_LOCK')">Swap Caps Lock and Esc</button>
</div>
<p>
    <textarea id="layout" name="layout" rows="20" required form="form" autocomplete="off" style="width: 100%;">type OVERLAY</textarea>
</p>
<p>
    <input type="submit" value="Download" form="form">
</p>

<h2>Layout customization</h2>
<p>
    The keyboard layout is customized using <a target="_blank" href="https://source.android.com/docs/core/input/key-character-map-files">Key Character Map file</a> syntax.
    To remap a physical key use <code>map key KEY_CODE ANDROID_KEY</code> syntax where <code>KEY_CODE</code> is the code that produced by the physical key and <code>ANDROID_KEY</code> is an Android key such as <code>ENTER</code>, <code>BRIGHTNESS_UP</code> or just a plain character like <code>1</code> or <code>A</code>.
    The default keyboard layout can be found in <a target="_blank" href="https://android.googlesource.com/platform/frameworks/base/+/master/data/keyboards/Generic.kl">Generic.kl</a> file in format <code>key KEY_CODE ANDROID_KEY</code>.
</p>
<p>
    For example you want to swap <kbd>Caps Lock</kbd> key and <kbd>Esc</kbd> key. To do this you need to map <kbd>Caps Lock</kbd> key to <kbd>Esc</kbd> key and vice versa.
    Open <a target="_blank" href="https://android.googlesource.com/platform/frameworks/base/+/master/data/keyboards/Generic.kl">Generic.kl</a> and find out what <code>KEY_CODE</code> (2-nd column) is produced by each <code>ANDROID_KEY</code> (3-rd column).
    It's <code>1</code> for <code>ESCAPE</code> and <code>58</code> for <code>CAPS_LOCK</code> by default.
    Add corresponding mappings in format <code>map key KEY_CODE ANDROID_KEY</code>.
    And don't forget to add <code>type OVERLAY</code> as the very first line.
    Final result will be:
    <pre>
        type OVERLAY

        map key 58 ESCAPE
        map key 1 CAPS_LOCK
    </pre>
</p>
<p>
    Some keyboards have media-keys or other keys that don't work as expected. To remap them you should find out what key codes they produce.
    There are several Android apps to do it. For example <a target="_blank" href="https://play.google.com/store/apps/details?id=ru.elron.gamepadtester">Gamepad tester</a> (note that it uses 'scan code' to refer to a key code).
</p>
<p>
    More complex customization (combinations with modifier keys like <kbd>Ctrl</kbd>/<kbd>Alt</kbd>/<kbd>Shift</kbd> or producing non-English characters) is also possible. Learn more in <a target="_blank" href="https://source.android.com/docs/core/input/key-character-map-files#how-key-combinations-are-mapped-to-behaviors">official documentation</a>.
</p>

<h2>Limitations</h2>
<p>
    Only single keyboard layout is supported. It may be changed in the future.
    If you need multiple custom keyboard layouts (for example for multiple languages), take a look at <a target="_blank" href="https://github.com/ris58h/custom-keyboard-layout">Custom Keyboard Layout</a> project.
</p>

<hr>

<p>
    Source code: <a target="_blank" href="https://github.com/ris58h/exkeymo-web">GitHub</a>
    <br/>
    Contacts: <a href="mailto:ris58h@gmail.com">Email</a>
</p>
</body>
</html>
